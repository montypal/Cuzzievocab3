<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cuzzie Vocab Showdown</title>
  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #2b3580 0, #0b1025 40%, #02030b 100%);
      color: #f8f8ff;
    }

    .game-container {
      max-width: 960px;
      margin: 0 auto;
      padding: 24px 16px 40px;
    }

    header {
      text-align: center;
      margin-bottom: 20px;
    }

    .title {
      font-size: 2.4rem;
      font-weight: 800;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: #ffd54f;
      text-shadow: 0 0 10px rgba(0,0,0,0.8);
    }

    .subtitle {
      font-size: 1rem;
      color: #b0c4ff;
    }

    .panel {
      background: rgba(6, 12, 40, 0.9);
      border-radius: 14px;
      padding: 18px 20px;
      margin-bottom: 16px;
      box-shadow: 0 0 22px rgba(0,0,0,0.6);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .stats-row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      justify-content: space-between;
      align-items: center;
      font-size: 0.95rem;
      color: #e0e6ff;
    }

    .stat-label {
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #90caf9;
      margin-right: 6px;
    }

    .xp-value {
      font-size: 1.3rem;
      font-weight: 700;
      color: #ffeb3b;
    }

    .streak {
      color: #ffcc80;
      font-weight: 600;
    }

    .question-counter {
      color: #b0bec5;
    }

    .mode-badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.8rem;
      font-weight: 700;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      background: linear-gradient(135deg, #ffeb3b, #ffa000);
      color: #231b00;
    }

    .mode-badge.gold-off {
      background: linear-gradient(135deg, #cfd8dc, #78909c);
      color: #111827;
    }

    .question-text {
      font-size: 1.05rem;
      line-height: 1.5;
      margin-bottom: 10px;
    }

    .question-prompt {
      font-size: 0.95rem;
      color: #b0c4ff;
      margin-bottom: 8px;
      font-style: italic;
    }

    .question-main {
      font-size: 1.15rem;
      font-weight: 600;
      color: #fffde7;
      margin-bottom: 14px;
    }

    .fill-blank {
      background: rgba(15, 23, 42, 0.9);
      border-radius: 10px;
      padding: 10px 12px;
      font-size: 1.05rem;
      line-height: 1.5;
    }

    .blank {
      color: #ffeb3b;
      font-weight: 700;
      letter-spacing: 0.18em;
    }

    .options-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }

    .option-btn {
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.15);
      background: rgba(30, 64, 175, 0.4);
      color: #e3f2fd;
      padding: 8px 12px;
      font-size: 0.95rem;
      cursor: pointer;
      text-align: left;
      transition: all 0.15s ease-out;
    }

    .option-btn:hover {
      background: rgba(66, 165, 245, 0.7);
      transform: translateY(-1px);
    }

    .option-btn.selected {
      background: #ffca28;
      color: #111827;
      border-color: #ffb300;
      box-shadow: 0 0 12px rgba(255, 213, 79, 0.7);
    }

    .option-btn.correct {
      background: #66bb6a;
      border-color: #43a047;
      color: #02210a;
    }

    .option-btn.incorrect {
      background: #ef5350;
      border-color: #c62828;
      color: #fff3f3;
    }

    .input-row {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .input-row input[type="text"] {
      flex: 1;
      min-width: 140px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: rgba(15, 23, 42, 0.9);
      color: #e3f2fd;
      font-size: 0.95rem;
    }

    .input-row input[type="text"]::placeholder {
      color: #6b7280;
    }

    .controls-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      justify-content: space-between;
      margin-top: 14px;
    }

    .left-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
    }

    .btn {
      border-radius: 999px;
      border: none;
      padding: 8px 14px;
      font-size: 0.95rem;
      font-weight: 600;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      cursor: pointer;
      transition: all 0.15s ease-out;
    }

    .btn-primary {
      background: linear-gradient(135deg, #42a5f5, #1e88e5);
      color: #e3f2fd;
      box-shadow: 0 0 12px rgba(33, 150, 243, 0.7);
    }

    .btn-primary:hover {
      background: linear-gradient(135deg, #64b5f6, #2196f3);
      transform: translateY(-1px);
    }

    .btn-secondary {
      background: rgba(148, 163, 184, 0.4);
      color: #e2e8f0;
    }

    .btn-secondary:hover {
      background: rgba(148, 163, 184, 0.7);
      transform: translateY(-1px);
    }

    .btn-gold-toggle {
      background: linear-gradient(135deg, #ffeb3b, #ffa000);
      color: #1f2933;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .btn-gold-toggle.off {
      background: rgba(120, 144, 156, 0.6);
      color: #eceff1;
      box-shadow: none;
    }

    .btn-gold-toggle span {
      font-size: 0.8rem;
    }

    .gold-note {
      font-size: 0.8rem;
      color: #ffe082;
      margin-top: 4px;
    }

    .announcer {
      font-size: 0.9rem;
      color: #c5cae9;
      font-style: italic;
      margin-top: 8px;
    }

    .feedback {
      margin-top: 10px;
      border-radius: 10px;
      padding: 10px 12px;
      font-size: 0.9rem;
    }

    .feedback.correct {
      background: rgba(56, 142, 60, 0.18);
      border: 1px solid rgba(129, 199, 132, 0.7);
      color: #e8f5e9;
    }

    .feedback.incorrect {
      background: rgba(211, 47, 47, 0.18);
      border: 1px solid rgba(239, 83, 80, 0.7);
      color: #ffebee;
    }

    .feedback strong {
      color: #fffde7;
    }

    .small-label {
      font-size: 0.8rem;
      color: #90a4ae;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 4px;
    }

    .word-highlight {
      color: #ffeb3b;
      font-weight: 700;
    }

    footer {
      text-align: center;
      margin-top: 18px;
      font-size: 0.75rem;
      color: #78909c;
    }

    @media (max-width: 600px) {
      .title {
        font-size: 1.8rem;
      }
      .stats-row {
        flex-direction: column;
        align-items: flex-start;
        gap: 6px;
      }
    }
  </style>
</head>
<body>
<div class="game-container">
  <header>
    <div class="title">Cuzzie Vocab Showdown</div>
    <div class="subtitle">Earn XP, go for the gold, and prove your vocabulary is incontrovertible.</div>
  </header>

  <section class="panel">
    <div class="stats-row">
      <div>
        <span class="stat-label">XP</span>
        <span class="xp-value" id="xpDisplay">0</span>
      </div>
      <div>
        <span class="stat-label">Streak</span>
        <span class="streak" id="streakDisplay">0</span>
      </div>
      <div>
        <span class="stat-label">Question</span>
        <span class="question-counter" id="questionCounter">1</span>
      </div>
      <div>
        <span id="modeBadge" class="mode-badge gold-off">Go for the Gold: OFF</span>
      </div>
    </div>
  </section>

  <section class="panel">
    <div class="small-label">Round Prompt</div>
    <div class="question-prompt" id="questionPrompt">
      The lights are hot, the crowd is roaring. Your word awaits…
    </div>

    <div id="questionArea" class="question-text">
      <!-- Question content injected by JS -->
    </div>

    <div id="answerArea">
      <!-- Answer controls injected by JS -->
    </div>

    <div class="controls-row">
      <div class="left-controls">
        <button class="btn btn-primary" id="submitButton">Lock in answer</button>
        <button class="btn btn-secondary" id="nextButton" disabled>Next question</button>
      </div>
      <button class="btn btn-gold-toggle off" id="goldToggleButton">
        ⭐ Go for the Gold
        <span>(+200 XP / −200 XP)</span>
      </button>
    </div>
    <div class="gold-note">
      Normal question: +100 XP if correct. Go for the Gold: double reward, double penalty.
    </div>
    <div class="announcer" id="announcerText">
      Announcer: “Will you play it safe, or chase that glittering XP?”
    </div>

    <div id="feedbackArea"></div>
  </section>

  <footer>
    Built for legendary cuzzies who think “sine qua non” is just part of their vernacular.
  </footer>
</div>

<script>
  // === VOCAB DATA ===========================================================
  // Each entry: word, definition, example sentence, and a nuance/synonym clue.
  const VOCAB = [
    {
      word: "ubiquitous",
      definition: "present or found everywhere",
      example: "During cuzzie week, inside jokes seem ubiquitous—no matter where you go, one pops up.",
      nuance: "Describes something that appears to be all over the place at once."
    },
    {
      word: "garrulous",
      definition: "excessively talkative",
      example: "The normally garrulous cousins fell silent when the roller coaster reached the zenith of its climb.",
      nuance: "Especially talkative in a rambling, sometimes trivial way."
    },
    {
      word: "lionize",
      definition: "to treat as an object of great interest or importance",
      example: "They continued to lionize Nani’s cooking, insisting it was a panacea for all sadness.",
      nuance: "To praise and treat someone like a celebrity."
    },
    {
      word: "fetid",
      definition: "smelling extremely unpleasant",
      example: "The fetid locker room was an affront to their normally fastidious standards.",
      nuance: "Focuses specifically on a horrible smell."
    },
    {
      word: "macabre",
      definition: "disturbing and horrifying because of involvement with or depiction of death and injury",
      example: "The movie’s macabre scenes were too much for the more timorous cousins.",
      nuance: "Often used for horror stories, grisly art, or dark themes."
    },
    {
      word: "preternatural",
      definition: "exceeding what is natural or regular; extraordinary",
      example: "Jaya has a preternatural ability to remember every single vocab word.",
      nuance: "So beyond normal that it feels almost supernatural."
    },
    {
      word: "iconoclast",
      definition: "a person who attacks or criticizes cherished beliefs or institutions",
      example: "The iconoclast in the family rolled their eyes at the sacrosanct tradition of group photos.",
      nuance: "Not just different, but actively challenges what others revere."
    },
    {
      word: "tragicomic",
      definition: "manifesting both tragic and comic aspects",
      example: "The cousins found it tragicomic when the ride broke right as they reached the front.",
      nuance: "Something that is sad and funny at the same time."
    },
    {
      word: "vox populi",
      definition: "Latin for “the voice of the people”",
      example: "The vox populi was clear: the cousins demanded ice cream before going home.",
      nuance: "Refers to popular opinion, not just one person’s view."
    },
    {
      word: "inimitable",
      definition: "so good or unusual as to be impossible to copy; unique",
      example: "Their inimitable group chat humor could never be replicated by outsiders.",
      nuance: "Uniqueness that is so strong others can’t match it."
    },
    {
      word: "supplicant",
      definition: "a person making a humble or earnest plea",
      example: "Aria became a supplicant, begging for just one more ride before leaving.",
      nuance: "Emphasizes humility when asking for something."
    },
    {
      word: "erstwhile",
      definition: "former; previous",
      example: "Their erstwhile enemy Henry became a reluctant ally when the line-cutter appeared.",
      nuance: "Refers to something that used to be true, but no longer is."
    },
    {
      word: "Pyrrhic victory",
      definition: "a victory gained at such a great cost that it is almost a defeat",
      example: "Winning the argument but missing the whole ride felt like a Pyrrhic victory.",
      nuance: "You technically win, but it hurts you so much that it barely counts as a win."
    },
    {
      word: "boondoggle",
      definition: "a wasteful or impractical project",
      example: "Their plan to visit every ride twice in one day was a glorious boondoggle.",
      nuance: "Sounds impressive, but mostly wastes time or resources."
    },
    {
      word: "fastidious",
      definition: "extremely or excessively careful or detailed",
      example: "Kaiya’s fastidious packing list included three different backup snacks, just in case.",
      nuance: "Can be positive (careful) or slightly negative (picky)."
    },
    {
      word: "perfunctory",
      definition: "carried out with minimal effort or reflection; superficial",
      example: "Their perfunctory thanks to the ride operator did not match how thrilled they actually felt.",
      nuance: "Doing something just to get it over with, without real feeling."
    },
    {
      word: "dour",
      definition: "relentlessly severe, stern, or gloomy",
      example: "The dour security guard did not laugh at their saccharine jokes.",
      nuance: "Not just serious, but joyless and grim."
    },
    {
      word: "nihilism",
      definition: "the belief that life is meaningless and all values are baseless",
      example: "After the churro stand closed, Akshay jokingly declared he had fallen into nihilism.",
      nuance: "Extreme pessimism about meaning or values."
    },
    {
      word: "gourmand",
      definition: "someone fond of eating and drinking",
      example: "Every gourmand in the family agreed that Din Tai Fung was sacrosanct.",
      nuance: "Not just someone who eats, but really loves food."
    },
    {
      word: "sagacity",
      definition: "keen mental discernment and good judgment; wisdom",
      example: "With unusual sagacity, Aarav suggested they check the wait times before running to the ride.",
      nuance: "A deep, practical kind of wisdom."
    },
    {
      word: "hyperbole",
      definition: "extravagant exaggeration",
      example: "Claiming the line was ‘a billion hours long’ was obvious hyperbole.",
      nuance: "Exaggeration used for effect, not meant to be taken literally."
    },
    {
      word: "maelstrom",
      definition: "a situation or state of confused movement or violent turmoil",
      example: "The exit gate turned into a maelstrom of strollers, balloons, and cousins.",
      nuance: "Not just chaos, but swirling, intense chaos."
    },
    {
      word: "rebuke",
      definition: "to scold or criticize sharply",
      example: "They tried to rebuke Henry for cutting in line, but he simply shrugged.",
      nuance: "Sharper than “correct,” but not necessarily a long rant."
    },
    {
      word: "convivial",
      definition: "friendly, lively, and enjoyable; characterized by feasting and merriment",
      example: "The evening ended in a convivial dinner full of laughter and inside jokes.",
      nuance: "Warm social atmosphere with fun and food."
    },
    {
      word: "apocryphal",
      definition: "of doubtful authenticity, though widely circulated as true",
      example: "The apocryphal story about someone puking on every ride turned out to be exaggerated.",
      nuance: "A questionable story people keep repeating."
    },
    {
      word: "intransigent",
      definition: "unwilling to compromise or change one’s views",
      example: "Aria was intransigent: there would be boba, or there would be mutiny.",
      nuance: "Stubborn specifically about refusing compromise."
    },
    {
      word: "ostracize",
      definition: "to exclude from a group",
      example: "The cousins threatened to ostracize anyone who said the trip was ‘mid.’",
      nuance: "Social exclusion on purpose."
    },
    {
      word: "discreet",
      definition: "careful not to attract attention or cause embarrassment",
      example: "They were discreet about sneaking snacks into the movie, or so they hoped.",
      nuance: "About being subtle and low-key."
    },
    {
      word: "avant garde",
      definition: "new and unusual or experimental ideas, especially in the arts",
      example: "Their avant garde family photo posed everyone mid-jump, shouting vocab words.",
      nuance: "Boldly unconventional, often artsy."
    },
    {
      word: "non sequitur",
      definition: "a conclusion or statement that does not logically follow from the previous statement",
      example: "Henry’s random soliloquy about tacos was a complete non sequitur in the conversation about math.",
      nuance: "Logical disconnect, not just a new topic."
    },
    {
      word: "zealot",
      definition: "a person who is fanatical and uncompromising about their ideals",
      example: "The churro zealot insisted that no other dessert was worth considering.",
      nuance: "Intense, almost extreme enthusiasm for a belief."
    },
    {
      word: "mercurial",
      definition: "characterized by rapid and unpredictable changes of mood",
      example: "The group chat’s mercurial energy switched from rancor to schadenfreude in seconds.",
      nuance: "Mood that shifts suddenly and unpredictably."
    },
    {
      word: "parsimonious",
      definition: "unwilling to spend money or use resources; stingy",
      example: "Calling Nani parsimonious was mendacious—her largess was legendary.",
      nuance: "Goes beyond ‘careful’: actively stingy."
    },
    {
      word: "abstruse",
      definition: "difficult to understand; obscure",
      example: "The roller coaster’s safety sign was so abstruse that no one read past line two.",
      nuance: "Hard to understand even if you’re trying."
    },
    {
      word: "mendacious",
      definition: "not telling the truth; lying",
      example: "His mendacious claim that the line was ‘only five minutes’ led to an hour of waiting.",
      nuance: "Habitually or deliberately untruthful."
    },
    {
      word: "quandary",
      definition: "a state of perplexity or doubt",
      example: "They were in a quandary: boba first or ride first?",
      nuance: "Stuck between options, unsure what to choose."
    },
    {
      word: "circumvent",
      definition: "to manage to get around, especially by clever strategy",
      example: "With sagacity, they used the app to circumvent the longest lines.",
      nuance: "A clever workaround, not brute force."
    },
    {
      word: "conflagration",
      definition: "a large disastrous fire or a major conflict",
      example: "A single spilled drink almost sparked a conflagration between the cousins.",
      nuance: "Huge, intense destruction or conflict."
    },
    {
      word: "nadir",
      definition: "the lowest point",
      example: "Realizing the park was closing while they were still in line was the emotional nadir of the day.",
      nuance: "Opposite of zenith; the bottom moment."
    },
    {
      word: "neophyte",
      definition: "a beginner",
      example: "Aria was a neophyte at roller coasters, but by the end she was fearless.",
      nuance: "Someone new to a particular skill or activity."
    },
    {
      word: "avarice",
      definition: "excessive or insatiable desire for wealth or gain",
      example: "Their avarice for prize tickets turned the arcade into a competitive maelstrom.",
      nuance: "Greed specifically for money or gain."
    },
    {
      word: "soliloquy",
      definition: "an act of talking to oneself; a dramatic monologue",
      example: "Akshay’s soliloquy about dessert options could have filled an entire play.",
      nuance: "A long solo speech, especially in drama."
    },
    {
      word: "esoteric",
      definition: "intended for or understood by only a small number of people",
      example: "Their most esoteric jokes depended on knowing every cousin’s middle name.",
      nuance: "So specialized that only insiders understand."
    },
    {
      word: "zeitgeist",
      definition: "the defining spirit or mood of a particular period of history",
      example: "Their group selfies perfectly captured the zeitgeist of early‑2020s cousin chaos.",
      nuance: "The general ‘vibe’ of an era."
    }
  ];

  // === GAME STATE ============================================================
  let xp = 0;
  let streak = 0;
  let questionNumber = 1;
  let currentQuestion = null;
  let questionLocked = false;
  let goForGold = false;

  const BASE_XP = 100;
  const GOLD_MULTIPLIER = 2;

  // === DOM ELEMENTS ==========================================================
  const xpDisplay = document.getElementById("xpDisplay");
  const streakDisplay = document.getElementById("streakDisplay");
  const questionCounter = document.getElementById("questionCounter");
  const modeBadge = document.getElementById("modeBadge");
  const questionPrompt = document.getElementById("questionPrompt");
  const questionArea = document.getElementById("questionArea");
  const answerArea = document.getElementById("answerArea");
  const feedbackArea = document.getElementById("feedbackArea");
  const announcerText = document.getElementById("announcerText");
  const submitButton = document.getElementById("submitButton");
  const nextButton = document.getElementById("nextButton");
  const goldToggleButton = document.getElementById("goldToggleButton");

  // === UTILITIES =============================================================
  function shuffle(array) {
    const arr = array.slice();
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
  }

  function getRandomWord(excludeWord = null) {
    let candidates = VOCAB;
    if (excludeWord) {
      candidates = VOCAB.filter(item => item.word !== excludeWord);
    }
    return candidates[Math.floor(Math.random() * candidates.length)];
  }

  function randomChoice(list) {
    return list[Math.floor(Math.random() * list.length)];
  }

  function updateStats() {
    xpDisplay.textContent = xp;
    streakDisplay.textContent = streak;
    questionCounter.textContent = questionNumber;
  }

  function setAnnouncer(message) {
    announcerText.textContent = "Announcer: " + message;
  }

  function setFeedback(html, isCorrect) {
    feedbackArea.innerHTML = html;
    feedbackArea.className = "feedback " + (isCorrect ? "correct" : "incorrect");
  }

  function resetFeedback() {
    feedbackArea.innerHTML = "";
    feedbackArea.className = "";
  }

  function toggleGoldMode() {
    goForGold = !goForGold;
    if (goForGold) {
      goldToggleButton.classList.remove("off");
      modeBadge.classList.remove("gold-off");
      modeBadge.textContent = "Go for the Gold: ON";
      setAnnouncer("“Gold mode engaged! Double XP glory—or double XP disaster.”");
    } else {
      goldToggleButton.classList.add("off");
      modeBadge.classList.add("gold-off");
      modeBadge.textContent = "Go for the Gold: OFF";
      setAnnouncer("“Back to classic play. Still 100 XP on the line every round.”");
    }
  }

  goldToggleButton.addEventListener("click", () => {
    if (questionLocked) return;
    toggleGoldMode();
  });

  // === QUESTION GENERATION ===================================================

  function generateQuestion() {
    resetFeedback();
    questionLocked = false;
    submitButton.disabled = false;
    nextButton.disabled = true;

    const qType = randomChoice(["definitionWord", "fillBlank", "nuance"]);
    const vocabItem = getRandomWord();

    currentQuestion = {
      type: qType,
      item: vocabItem,
      selectedOption: null
    };

    if (qType === "definitionWord") {
      renderDefinitionQuestion(vocabItem);
    } else if (qType === "fillBlank") {
      renderFillBlankQuestion(vocabItem);
    } else {
      renderNuanceQuestion(vocabItem);
    }

    const prompts = {
      definitionWord: "Name that word: the crowd whispers, you step into the spotlight…",
      fillBlank: "Fill in the blank with the perfect word—asterisks and all.",
      nuance: "Shade of meaning round: can you catch the subtle nuance?"
    };
    questionPrompt.textContent = prompts[qType];
  }

  function renderDefinitionQuestion(item) {
    const wrong1 = getRandomWord(item.word);
    const wrong2 = getRandomWord(item.word);
    const wrong3 = getRandomWord(item.word);

    const options = shuffle([item.word, wrong1.word, wrong2.word, wrong3.word]);

    questionArea.innerHTML = `
      <div class="question-main">
        Which word best matches this definition?
      </div>
      <div class="question-text">
        “${item.definition}”
      </div>
    `;

    const optionsHtml = options.map((opt, idx) => `
      <button class="option-btn" data-option="${opt}">${String.fromCharCode(65 + idx)}. ${opt}</button>
    `).join("");

    answerArea.innerHTML = `
      <div class="options-grid">
        ${optionsHtml}
      </div>
    `;

    const buttons = answerArea.querySelectorAll(".option-btn");
    buttons.forEach(btn => {
      btn.addEventListener("click", () => {
        if (questionLocked) return;
        buttons.forEach(b => b.classList.remove("selected"));
        btn.classList.add("selected");
        currentQuestion.selectedOption = btn.getAttribute("data-option");
      });
    });
  }

  function renderFillBlankQuestion(item) {
    const masked = item.word.replace(/[A-Za-z]/g, "*"); // asterisks
    const sentence = item.example.replace(new RegExp(item.word, "i"), `<span class="blank">${masked}</span>`);

    questionArea.innerHTML = `
      <div class="question-main">
        Fill in the blank with the correct vocabulary word.
      </div>
      <div class="fill-blank">
        ${sentence}
      </div>
    `;

    answerArea.innerHTML = `
      <div class="input-row">
        <input type="text" id="fillInput" placeholder="Type the missing word here…" autocomplete="off" />
      </div>
    `;
  }

  function renderNuanceQuestion(item) {
    // Ask for the word that matches the nuance text
    const wrong1 = getRandomWord(item.word);
    const wrong2 = getRandomWord(item.word);
    const wrong3 = getRandomWord(item.word);
    const options = shuffle([item.word, wrong1.word, wrong2.word, wrong3.word]);

    questionArea.innerHTML = `
      <div class="question-main">
        Which word best matches this description?
      </div>
      <div class="question-text">
        ${item.nuance}
      </div>
    `;

    const optionsHtml = options.map((opt, idx) => `
      <button class="option-btn" data-option="${opt}">${String.fromCharCode(65 + idx)}. ${opt}</button>
    `).join("");

    answerArea.innerHTML = `
      <div class="options-grid">
        ${optionsHtml}
      </div>
    `;

    const buttons = answerArea.querySelectorAll(".option-btn");
    buttons.forEach(btn => {
      btn.addEventListener("click", () => {
        if (questionLocked) return;
        buttons.forEach(b => b.classList.remove("selected"));
        btn.classList.add("selected");
        currentQuestion.selectedOption = btn.getAttribute("data-option");
      });
    });
  }

  // === ANSWER CHECKING & SCORING ============================================

  function normalize(text) {
    return text.trim().toLowerCase().replace(/\s+/g, " ");
  }

  function checkAnswer() {
    if (questionLocked) return;
    if (!currentQuestion) return;

    const item = currentQuestion.item;
    let userAnswer = null;
    let isCorrect = false;

    if (currentQuestion.type === "fillBlank") {
      const input = document.getElementById("fillInput");
      if (!input || !input.value.trim()) {
        setAnnouncer("“You haven’t locked in anything yet. The crowd demands a guess!”");
        return;
      }
      userAnswer = normalize(input.value);
      isCorrect = userAnswer === normalize(item.word);
    } else {
      if (!currentQuestion.selectedOption) {
        setAnnouncer("“Choose an option before you lock in—no psychic answers accepted.”");
        return;
      }
      userAnswer = currentQuestion.selectedOption;
      isCorrect = normalize(userAnswer) === normalize(item.word);

      // Update button styling
      const buttons = answerArea.querySelectorAll(".option-btn");
      buttons.forEach(btn => {
        const opt = btn.getAttribute("data-option");
        if (normalize(opt) === normalize(item.word)) {
          btn.classList.add("correct");
        }
        if (normalize(opt) === normalize(userAnswer) && !isCorrect) {
          btn.classList.add("incorrect");
        }
        btn.classList.remove("selected");
      });
    }

    // XP calculation
    let delta = 0;
    if (isCorrect) {
      delta = goForGold ? BASE_XP * GOLD_MULTIPLIER : BASE_XP;
      xp += delta;
      streak += 1;
      const streakMsg = streak >= 3 ? ` Your streak of ${streak} is becoming downright preternatural.` : "";
      const xpMsg = goForGold
        ? `+${delta} XP for that golden guess!`
        : `+${delta} XP for a solid hit.`;

      setFeedback(
        `<strong>Correct!</strong> The word was <span class="word-highlight">${item.word}</span>.<br>
         Definition: ${item.definition}.<br>
         Example: “${item.example}”<br>
         ${xpMsg}${streakMsg}`,
        true
      );
      setAnnouncer("“The board lights up green—what a virtuoso performance!”");
    } else {
      delta = goForGold ? -BASE_XP * GOLD_MULTIPLIER : 0;
      xp = Math.max(0, xp + delta);
      streak = 0;

      let explanation = "";
      if (currentQuestion.type === "definitionWord" || currentQuestion.type === "nuance") {
        explanation = `
          You chose <strong>${userAnswer}</strong>, but that doesn’t quite match the clue.<br>
          <strong>${item.word}</strong> means: ${item.definition}.<br>
          Example: “${item.example}”
        `;
      } else {
        explanation = `
          You answered <strong>${userAnswer}</strong>, but the missing word was
          <span class="word-highlight">${item.word}</span>.<br>
          Definition: ${item.definition}.<br>
          Example: “${item.example}”
        `;
      }

      const xpMsg = goForGold
        ? `Because you went for the gold and missed, you lost ${Math.abs(delta)} XP.`
        : `No XP this time—but the explanation should mollify your confusion.`;

      setFeedback(
        `<strong>Not quite.</strong> ${explanation}<br>${xpMsg}`,
        false
      );
      setAnnouncer("“Oof, the audience gasps—but every misstep is just vocab training, not an ignominious defeat.”");
    }

    updateStats();
    questionLocked = true;
    submitButton.disabled = true;
    nextButton.disabled = false;
  }

  submitButton.addEventListener("click", checkAnswer);

  nextButton.addEventListener("click", () => {
    if (!questionLocked) {
      setAnnouncer("“You haven’t locked in your answer yet—no skipping the scary question!”");
      return;
    }
    questionNumber += 1;
    updateStats();
    generateQuestion();
  });

  // === INITIALIZE ============================================================
  updateStats();
  generateQuestion();
</script>
</body>
</html>
