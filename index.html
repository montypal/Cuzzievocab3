function renderTermToDefinition(item) {
  const wrong = shuffle(VOCAB.filter(v => v.word !== item.word)).slice(0, 3);
  const options = shuffle([item.definition, ...wrong.map(w => w.definition)]);

  questionArea.innerHTML = `
    <div class="question-main">
      What is the definition of <span class="word-highlight">${item.word}</span>?
    </div>
  `;

  answerArea.innerHTML = `
    <div class="options-grid">
      ${options
        .map(
          (o, i) => `
            <button class="option-btn" data-opt="${o}">
              ${String.fromCharCode(65 + i)}. ${o}
            </button>
          `
        )
        .join("")}
    </div>
  `;

  answerArea.querySelectorAll(".option-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      if (questionLocked) return;
      answerArea.querySelectorAll(".option-btn").forEach(b => b.classList.remove("selected"));
      btn.classList.add("selected");
      currentQuestion.selected = btn.dataset.opt;
    });
  });
}

/* ===========================
   CHECK ANSWER
   =========================== */
function checkAnswer() {
  if (questionLocked) return;

  const item = currentQuestion.item;
  let userAnswer = null;
  let correct = false;

  if (currentQuestion.type === "fillBlank") {
    const input = document.getElementById("fillInput");
    if (!input.value.trim()) return;
    userAnswer = normalize(input.value);
    correct = userAnswer === normalize(item.word);

  } else if (currentQuestion.type === "termToDefinition") {
    userAnswer = currentQuestion.selected;
    correct = normalize(userAnswer) === normalize(item.definition);

  } else {
    userAnswer = currentQuestion.selected;
    correct = normalize(userAnswer) === normalize(item.word);
  }

  questionLocked = true;
  submitButton.disabled = true;
  nextButton.disabled = false;

  let xpChange = 0;

  if (correct) {
    xpChange = goForGold ? BASE_XP * GOLD_MULTIPLIER : BASE_XP;
    xp += xpChange;
    streak++;

    feedbackArea.innerHTML = `
      <div class="feedback correct">
        <strong>Correct!</strong><br>
        Word: <span class="word-highlight">${item.word}</span><br>
        Definition: ${item.definition}<br>
        Example: "${item.example}"<br>
        +${xpChange} XP
      </div>
    `;
  } else {
    xpChange = goForGold ? -BASE_XP * GOLD_MULTIPLIER : 0;
    xp = Math.max(0, xp + xpChange);
    streak = 0;

    feedbackArea.innerHTML = `
      <div class="feedback incorrect">
        <strong>Incorrect.</strong><br>
        Correct word: <span class="word-highlight">${item.word}</span><br>
        Definition: ${item.definition}<br>
        Example: "${item.example}"<br>
        ${xpChange < 0 ? `${xpChange} XP (Gold penalty)` : ""}
      </div>
    `;
  }

  // Gold cooldown logic
  if (goForGold) {
    goForGold = false;
    goldCooldown = 3;
  }

  updateGoldUI();
  updateStats();
}

/* ===========================
   BUTTONS
   =========================== */
submitButton.addEventListener("click", checkAnswer);

nextButton.addEventListener("click", () => {
  if (!questionLocked) return;

  questionNumber++;
  if (goldCooldown > 0) goldCooldown--;
  updateGoldUI();
  updateStats();
  generateQuestion();
});

/* ===========================
   START GAME
   =========================== */
updateStats();
generateQuestion();
